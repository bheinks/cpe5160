C51 COMPILER V9.53.0.0   LCD                                                               10/12/2018 14:45:19 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN LCD.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE LCD.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include "main.h"
   2          #include "PORT.h"
   3          #include "delay.h"
   4          #include "LCD.h"
   5          
   6          void LCD_write(bit reg_select, uint8_t lcd_data) {
   7   1          RS = reg_select;
   8   1          E = 1;
   9   1          P0 = lcd_data;
  10   1          E = 0;
  11   1          P0 = 0xFF;
  12   1          RS = 1;
  13   1      }
  14          
  15          void LCD_init(void) {
  16   1          // 8-bit interface, 2 lines, 5x8 font
  17   1          LCD_write(COMMAND, FUNCTION_SET|TWO_LINE|SET_5x8); 
  18   1          delay(5);
  19   1          LCD_write(COMMAND, FUNCTION_SET|TWO_LINE|SET_5x8); 
  20   1          delay(1);
  21   1          LCD_write(COMMAND, FUNCTION_SET|TWO_LINE|SET_5x8); 
  22   1          delay(1);
  23   1          LCD_write(COMMAND, FUNCTION_SET|TWO_LINE|SET_5x8); 
  24   1          delay(1);
  25   1      
  26   1          // display on, cursor on and not blinking
  27   1          LCD_write(COMMAND, DISPLAY_CONTROL|DISPLAY_ON|CURSOR_OFF|BLINK_OFF);
  28   1          delay(1);
  29   1      
  30   1          // clear display
  31   1          LCD_write(COMMAND, CLEAR_DISPLAY);
  32   1          delay(2); // wait until complete
  33   1      
  34   1          // DDRAM address increments with no scrolling
  35   1          LCD_write(COMMAND, ENTRY_MODE|SHIFT_RIGHT|CURSOR);
  36   1          delay(1);
  37   1      }
  38          
  39          void LCD_print(uint8_t address, uint8_t num_bytes, uint8_t *string_p) {
  40   1          uint8_t character, index;
  41   1      
  42   1          if (address != NO_ADDR_CHANGE) {
  43   2              LCD_write(COMMAND, SET_DDRAM_ADDR|address);
  44   2              delay(1);
  45   2          }
  46   1      
  47   1          if (num_bytes == 0) {
  48   2              index = 0;
  49   2              character = *(string_p + index);
  50   2      
  51   2              while (character != 0) {
  52   3                  LCD_write(DDRAM, character);
  53   3                  delay(1);
  54   3                  index++;
  55   3                  character = *(string_p + index);
C51 COMPILER V9.53.0.0   LCD                                                               10/12/2018 14:45:19 PAGE 2   

  56   3              }
  57   2          }
  58   1          else {
  59   2              for(index = 0; index < num_bytes; ++index) {
  60   3                  character = *(string_p + index);
  61   3                  LCD_write(DDRAM, character);
  62   3                  delay(1);
  63   3              }
  64   2          }
  65   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    240    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       7
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
